' ==================================================================
' 1. ACTIVITY DIAGRAM â€“ Workflow global avec garde-fous
' ==================================================================
@startuml Activity_Workflow_Certification
title ğŸ› ï¸ Workflow de Certification IndustrialisÃ© â€“ Diagramme d'activitÃ©s

start

:Chargement du fichier pivot (.csv ou .xlsx);
:Ã‰tape 1 â€“ Identification des exigences;
if (ID et ApplicabilitÃ© valides ?) then (Oui)
  :Validation auto OK;
else
  :Blocage â€“ Correction requise;
  stop
endif

:Ã‰tape 2 â€“ Allocation des exigences (TXE);
:Ã‰tape 3 â€“ DÃ©finition des MOP (XE);

:Ã‰tape 4 â€“ VÃ©rification des preuves;
if (Fichiers manquants ?) then (Oui)
  :Erreur bloquante;
  stop
endif

:Ã‰tape 5 â€“ VÃ©rification traÃ§abilitÃ© + statut;
if (Champs vides ?) then (Oui)
  :Blocage;
  stop
endif

:Revue 1er regard;
:Revue 2nd regard;

:Feu vert CAM;

:Ã‰tape 6 â€“ GÃ©nÃ©ration de la matrice Excel;
:Soumission au NoBo / DeBo;
:Traitement des retours Ã©valuateurs;
:Analyse d'impact si modification;
:Constitution du dossier d'AMM;

stop
@enduml

' ==================================================================
' 2. USE CASE DIAGRAM â€“ RÃ´les et responsabilitÃ©s
' ==================================================================
@startuml UseCase_Workflow_Certification
title ğŸ‘¥ RÃ´les et Cas dâ€™Utilisation â€“ Certification

actor CAM
actor XE
actor TXE
actor Script
actor Evaluateur as "NoBo / DeBo"

rectangle "SystÃ¨me Certification" {
  CAM --> (Valider pÃ©rimÃ¨tre des exigences)
  CAM --> (Autoriser soumission)
  CAM --> (Constituer le dossier AMM)

  TXE --> (Allouer les exigences)
  XE --> (DÃ©finir les MOP)
  XE --> (Fournir les preuves)

  Script --> (VÃ©rifier les preuves)
  Script --> (VÃ©rifier la traÃ§abilitÃ©)
  Script --> (Bloquer en cas de non-conformitÃ©)

  Evaluateur --> (Envoyer commentaires)
}
@enduml

' ==================================================================
' 3. SEQUENCE DIAGRAM â€“ Cas nominal de traitement dâ€™une exigence
' ==================================================================
@startuml Sequence_Certification_Flow
title â±ï¸ Traitement d'une exigence â€“ Diagramme de sÃ©quence

participant CAM
participant TXE
participant XE
participant Script
participant NoBo as "Ã‰valuateur"

CAM -> TXE : Identification + allocation exigence
TXE -> XE : Transfert de lâ€™exigence
XE -> Script : Demande vÃ©rification MOP
Script -> XE : OK / erreurs
XE -> Script : Fourniture de preuve
Script -> Script : VÃ©rifie preuve, statut, traÃ§abilitÃ©
alt Erreur dÃ©tectÃ©e
  Script --> XE : Blocage + rapport
  XE --> CAM : Alerte / Correction
else DonnÃ©es valides
  Script -> CAM : Validation possible
  CAM -> NoBo : Soumission preuve
  NoBo -> CAM : Retour commentaire
  CAM -> XE : Traitement retour
end

@enduml
